FROM centos:7.6.1810

RUN curl --silent --location https://rpm.nodesource.com/setup_8.x | bash -
RUN yum update -y && yum -y install nodejs bzip2 gcc

ENV NODE_TLS_REJECT_UNAUTHORIZED 0

ADD package.json /app/
WORKDIR /app

RUN npm install
ADD . /app
RUN npm run build

# remove blacklisted components
RUN rm -rf /tmp/* ./node_modules/commander ./node_modules/phantomjs-prebuilt

EXPOSE 9000

WORKDIR /app
ENTRYPOINT ["node", "./api/server.js"]
